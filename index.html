<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Movie Release</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <link rel="stylesheet" href="styles.css">

<!--
  <a class="button margin-right margin-top" href="http://www.imdb.com/title/" target="_blank">Movie info</a>

  $("#web").append("<a href='http://"+url+"' rel='external' data-direction='reverse'>"+url+"</a>");
imdbID
-->
  <script>
      function getSearchResult(){
        var search = document.getElementById("title").value;
        $.getJSON("http://www.omdbapi.com/?t=" + search + "&y=&plot=short&r=json", function(json) {
            if (json.Title == null){
              var span;
                span = $('<span/>');
                span.append("<h1>Looks like this movie does not exist, try again!</h1>");
                $('#movie').html(span);
              overLay()
            }
            else {
              var title = json.Title;
              var imdbID = json.imdbID;
              var dateVar = json.Released;
              var rlsDate = new Date(dateVar);
              var currentDate = new Date()
              rlsDays(rlsDate, currentDate, title, imdbID)
            }
          });
      };

      function rlsDays(rlsDate, currentDate, title, imdbID){
        var millisecondsPerDay = 1000 * 60 * 60 * 24;
        var millisBetween = rlsDate.getTime() - currentDate.getTime();
        var days = millisBetween / millisecondsPerDay;
        var daysResult = (Math.floor(days));
        if (daysResult < 0 && daysResult > -30) {
          var textResult = "<h1>Looks like " + title + " is already out! better hurry to the theater.</h1>";
        }
        else if (daysResult < -30 && daysResult > -80) {
          var textResult = "<h1>Looks like " + title + " Has been out for a while now, might be to late!</h1>";
        }
        else if (daysResult < -80 && daysResult > -150) {
          var textResult = "<h1>Yeah, to slow. Better check this site a little earlier next time, maybe see if " + title + " is out on Blu Ray or Netflix.</h1>";
        }
        else if (daysResult < -150) {
          var textResult = "<h1>You must have been living under a rock, " + title + " is old, long gone have been its moments of glory in the theater. </h1>";
        }
        else if (daysResult > 0 && daysResult < 10 ) {
          var textResult = "<h1>Almost time! Only <span id='days'></span> left for " + title + ", excitement is rising, better order those tickets before it’s too late.</h1>";
        }
        else {
          var textResult = "<h1><span id='days'></span> days left until " + title + ", you can relax, not time yet.</h1></span>";
        }
        var span;
          span = $('<span/>');
          span.append(textResult);
          $('#movie').html(span);
        var a;
          a = $('<a/>');
          a.append("<a class='button margin-right margin-top' href='http://www.imdb.com/title/" + imdbID + "'" + "target='_blank'>Movie info</a>");
          $('#imdbLink').html(a);

        var span;
          span = $('<span/>');
          span.append("<span>" + daysResult + "</span>");
          $('#days').html(span);
        overLay()
      };

      function overLay() {
        $(".overLay").slideToggle("slow");
      }

  </script>
</head>

<body>
<div class="bgvid-color"></div>
  <video autoplay loop poster="movie-reel22.jpg" id="bgvid">
      <source src="movie-reel44.webm" type="video/webm">
      <source src="movie-reel44.mp4" type="video/mp4">
  </video>

<div class="center-div">
  <h1>I can’t take it anymore! I must know, when do I run to the theater!? </h1>
  <hr></hr>
  <h2>How many days until...</h2>
  <div class="center-hor">
    <form id="searchForm" class="form-search" autocomplete="off">
      <input type="text" name=movie_title id="title" placeholder="Type your movie here...">
      <input type="button" value="Tell me!" onClick="getSearchResult()">
    </form>
  </div>
</div>

<div class="overLay">
  <div class="center-div">
     <span id="movie"></span>
    <hr></hr>
    <div class="center-hor2">
      <div id="imdbLink"></div><button class="button margin-top" onClick="overLay()">Search again</button>
    </div>
  </div>
</div>


</body>
</html>
